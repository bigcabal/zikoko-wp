$(document).ready(function(){function e(e,t,a){for(var o=e.split(" "),r="",l=360,i=40,c=0;c<o.length;c++){var f=r+o[c]+" ",m=n.measureText(f),d=m.width;d>l&&c>0?(n.fillText(r,30,t),r=o[c]+" ",t+=25,i+=25):r=f}n.fillText(r,30,t),a(i)}function t(e,t,a){for(var o,n=0;9999>n;n++){var l=Math.floor(Math.random()*r.length);if(r[l].gender===t|"any"===r[l].gender&&r[l].country===a|"any"===r[l].country){o=r[l];break}}for(var i=o.sentence,i=i.replace(/{{name}}/g,e),i=i.split("."),n=0;n<i.length;n++){i[n].charAt(0);" "===i[n].charAt(0)?i[n]=i[n].slice(1)+".":i[n]+="."}return i}function a(a,o){var r,l=document.getElementById("logo");r="male"===o?document.getElementById("figure-male"):document.getElementById("figure-female");var i=t(a,o);n.fillStyle="#fff",n.fillRect(0,0,600,350),n.lineWidth="6",n.strokeStyle="#8235b6",n.rect(0,0,600,350),n.stroke(),n.drawImage(r,460,50),n.drawImage(l,30,300),n.font="18px Montserrat",n.fillStyle="#000";for(var c=50,f=0;f<i.length;f++)e(i[f],c,function(e){c+=e})}var o=document.getElementById("beLikeZikoko"),n=o.getContext("2d"),r=ajaxinfo;$("#generateMeme").on("click",function(e){var t=$('input[name="name"]').val(),n=$('select[name="gender"]').val();$('select[name="country"]').val();a(t,n);var r=window.location.href,l="Be like "+t+". Make your story.",i=o.toDataURL("image/png");return $("li.download a").attr("href",i),$("li.facebook a").attr("href","https://facebook.com/dialog/feed?app_id=593692017438309&link="+r+"&name="+l+"&redirect_uri="+r),$("li.twitter a").attr("href","https://twitter.com/intent/tweet/?text="+l+"&url="+r+"&via=zikokomag&related=zikokomag"),$("li.repeat a").attr("href",window.location.href),$("#beLikeZikokoImg").attr("src",i),$(".belike-result").show(),$("html, body").animate({scrollTop:$(".belike-result").offset().top-20},500),o.toBlob?o.toBlob(function(e){console.log(e);var t=new FormData;t.append("action","ajax_upload"),t.append("image",e,"belike.png")},"image/png"):console.log("no"),!1})});